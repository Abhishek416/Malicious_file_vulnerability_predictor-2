import json
import csv

import pandas as pd

json_file_path = ["result.json", "result-1.json", "result-2.json", "result-3.json", "result-4.json", "result-5.json"]
res = []

def addData(data):
    for result in data:
        df = {}
        result = result['results']
        if result['response_code'] != 0:
            df['scan_id'] = result['scan_id']
            df['sha1'] = result['sha1']
            df['resouce'] = result['resource']
            df['scan_date'] = result['scan_date']
            df['total'] = result['total']
            df['positives'] = result['positives']
            df['sha256'] = result['sha256']
            df['md5'] = result['md5']
            for malware in result['scans']:
                df[malware] = result['scans'][malware]['detected']

            res.append(df)

for json_path in json_file_path:
    with open(json_path, "r") as read_file:
       data = json.load(read_file)
       
    addData(data)

file_csv = pd.DataFrame(res)
print(file_csv.head())
print(file_csv.shape)
file_csv.to_csv('result.csv')